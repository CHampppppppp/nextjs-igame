# iGame Lab å®˜ç½‘

æ™ºèƒ½å¯è§†åŒ–ä¸ä»¿çœŸå®éªŒå®¤å®˜æ–¹ç½‘ç«™ - åŸºäº Next.js æ„å»ºçš„ç°ä»£åŒ– Web åº”ç”¨

## ğŸš€ é¡¹ç›®ç®€ä»‹

è¿™æ˜¯ä¸€ä¸ªä¸“ä¸ºæ­å·ç”µå­ç§‘æŠ€å¤§å­¦ iGame Labï¼ˆæ™ºèƒ½å¯è§†åŒ–ä¸ä»¿çœŸå®éªŒå®¤ï¼‰æ‰“é€ çš„å®˜æ–¹ç½‘ç«™ï¼Œé›†æˆäº†å…ˆè¿›çš„ AI èŠå¤©åŠ©æ‰‹ã€å‘é‡æœç´¢è®°å¿†ç³»ç»Ÿå’Œä¸°å¯Œçš„è§†è§‰æ•ˆæœã€‚

## âœ¨ ä¸»è¦åŠŸèƒ½

### ğŸ¤– AI æ™ºèƒ½åŠ©æ‰‹
- **å¤šæ„å›¾è¯†åˆ«**ï¼šè‡ªåŠ¨è¯†åˆ«ç”¨æˆ·æŸ¥è¯¢æ„å›¾ï¼ˆæ—¶é—´æŸ¥è¯¢ã€å®éªŒå®¤ç›¸å…³é—®é¢˜ç­‰ï¼‰
- **æŒä¹…åŒ–å¯¹è¯**ï¼šåŸºäºæœ¬åœ°å­˜å‚¨çš„å¯¹è¯å†å²è®°å½•
- **æ™ºèƒ½è®°å¿†ç³»ç»Ÿ**ï¼šé›†æˆ RAGï¼ˆæ£€ç´¢å¢å¼ºç”Ÿæˆï¼‰æŠ€æœ¯ï¼Œæä¾›ç²¾å‡†å›ç­”
- **å®æ—¶å“åº”**ï¼šæµç•…çš„å®æ—¶å¯¹è¯ä½“éªŒ

### ğŸ“š è®°å¿†ç®¡ç†ç³»ç»Ÿ
- **å¤šæ ·åŒ–ä¸Šä¼ **ï¼šæ”¯æŒæ–‡æœ¬æ–‡ä»¶ã€PDF æ–‡æ¡£çš„ç›´æ¥ä¸Šä¼ 
- **æ™ºèƒ½åˆ†å—**ï¼šè‡ªåŠ¨å°†é•¿æ–‡æ¡£åˆ†å‰²ä¸ºåˆé€‚å¤§å°çš„å—
- **å‘é‡å­˜å‚¨**ï¼šä½¿ç”¨ Pinecone äº‘å‘é‡æ•°æ®åº“è¿›è¡Œé«˜æ•ˆå­˜å‚¨å’Œæ£€ç´¢
- **è¯­ä¹‰æœç´¢**ï¼šåŸºäºå‘é‡ç›¸ä¼¼åº¦çš„æ™ºèƒ½å†…å®¹æ£€ç´¢

### ğŸ¨ è§†è§‰ç‰¹æ•ˆ
- **é«˜çº§ Canvas èƒŒæ™¯**ï¼šå¤šå±‚æ¬¡åŠ¨æ€è§†è§‰æ•ˆæœ
  - ğŸŒŠ **æµä½“ç²’å­ç³»ç»Ÿ**ï¼šæ™ºèƒ½ç²’å­åŠ¨ç”»ï¼Œé¼ æ ‡äº¤äº’å“åº”
  - ğŸ§  **ç¥ç»ç½‘ç»œç½‘æ ¼**ï¼šé»‘è‰²èŠ‚ç‚¹ç½‘ç»œï¼Œæ™ºèƒ½è¿æ¥ç®—æ³•ï¼Œæ•°æ®æµè„‰å†²æ•ˆæœ
  - ğŸŒŠ **æ³¢æµªåŠ¨ç”»**ï¼šå¤šå±‚æ³¢æµªæ•ˆæœï¼Œè¥é€ æµåŠ¨æ„Ÿ
  - ğŸ”· **æµ®åŠ¨å‡ ä½•å›¾å½¢**ï¼šæ—‹è½¬çš„ä¸‰è§’å½¢ã€å…­è¾¹å½¢ç­‰å‡ ä½•å½¢çŠ¶
  - âš¡ **æ€§èƒ½ä¼˜åŒ–**ï¼šæ™ºèƒ½å¸§ç‡æ§åˆ¶ï¼Œè®¾å¤‡æ€§èƒ½è‡ªé€‚åº”
  - ğŸ›ï¸ **å®æ—¶æ§åˆ¶é¢æ¿**ï¼šå¯è°ƒèŠ‚ç²’å­æ•°é‡ã€åŠ¨ç”»é€Ÿåº¦ç­‰å‚æ•°
  - ğŸŒ **ä¼˜é›…åŠ¨ç”»é€Ÿåº¦**ï¼šæ•´ä½“åŠ¨ç”»èŠ‚å¥å‡æ…¢ï¼Œæ›´å…·æ²‰æµ¸æ„Ÿ
- **3D ç²’å­èƒŒæ™¯**ï¼šåŠ¨æ€ç²’å­ç³»ç»Ÿè¥é€ ç§‘æŠ€æ„Ÿ
- **æµç•…åŠ¨ç”»**ï¼šåŸºäº Framer Motion çš„é¡µé¢è¿‡æ¸¡åŠ¨ç”»
- **å“åº”å¼è®¾è®¡**ï¼šå®Œç¾é€‚é…å„ç§è®¾å¤‡å±å¹•
- **æ»šåŠ¨ç‰¹æ•ˆ**ï¼šæ™ºèƒ½æ»šåŠ¨è¿›åº¦æŒ‡ç¤ºå™¨

## ğŸ—ï¸ æŠ€æœ¯æ¶æ„

### å‰ç«¯æŠ€æœ¯æ ˆ
```
Next.js 16 + React 19 + TypeScript
Tailwind CSS + Framer Motion
Three.js + React Three Fiber
Canvas API + Web Animations
```

### AI & æ•°æ®å±‚
```
OpenAI GPT ç³»åˆ—æ¨¡å‹
Pinecone å‘é‡æ•°æ®åº“
LangChain æ¡†æ¶
```

### å¼€å‘å·¥å…·
```
ESLint + TypeScript
Vercel éƒ¨ç½²å¹³å°
```

## ğŸ“ é¡¹ç›®ç»“æ„

```
my-app/
â”œâ”€â”€ app/                          # Next.js App Router
â”‚   â”œâ”€â”€ api/                      # API è·¯ç”±
â”‚   â”‚   â”œâ”€â”€ chat/                 # èŠå¤© API
â”‚   â”‚   â””â”€â”€ memories/             # è®°å¿†ç®¡ç† API
â”‚   â”œâ”€â”€ components/               # é¡µé¢ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ ai/                   # AI ç›¸å…³ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ effects/              # è§†è§‰ç‰¹æ•ˆ
â”‚   â”‚   â”œâ”€â”€ layout/               # å¸ƒå±€ç»„ä»¶
â”‚   â”‚   â””â”€â”€ ui/                   # UI åŸºç¡€ç»„ä»¶
â”‚   â”œâ”€â”€ admin/                    # ç®¡ç†é¡µé¢
â”‚   â”œâ”€â”€ contact/                  # è”ç³»é¡µé¢
â”‚   â”œâ”€â”€ research/                 # ç ”ç©¶é¡µé¢
â”‚   â”œâ”€â”€ team/                     # å›¢é˜Ÿé¡µé¢
â”‚   â”œâ”€â”€ teambuilding/             # å›¢å»ºé¡µé¢
â”‚   â”œâ”€â”€ globals.css               # å…¨å±€æ ·å¼
â”‚   â”œâ”€â”€ layout.tsx                # æ ¹å¸ƒå±€
â”‚   â””â”€â”€ page.tsx                  # é¦–é¡µ
â”œâ”€â”€ lib/                          # å·¥å…·åº“
â”‚   â”œâ”€â”€ ai/                       # AI ç›¸å…³å·¥å…·
â”‚   â”‚   â”œâ”€â”€ chat.ts               # èŠå¤©æœåŠ¡
â”‚   â”‚   â”œâ”€â”€ embeddings.ts         # å‘é‡åµŒå…¥
â”‚   â”‚   â”œâ”€â”€ rag-chain.ts          # RAG ç³»ç»Ÿ
â”‚   â”‚   â””â”€â”€ tools.ts              # AI å·¥å…·
â”‚   â”œâ”€â”€ db/                       # æ•°æ®åº“ç›¸å…³
â”‚   â””â”€â”€ animations.ts             # åŠ¨ç”»å·¥å…·
â”œâ”€â”€ hooks/                        # è‡ªå®šä¹‰ Hooks
â”œâ”€â”€ scripts/                      # è„šæœ¬æ–‡ä»¶
â”‚   â”œâ”€â”€ setup/                    # è®¾ç½®è„šæœ¬
â”‚   â”œâ”€â”€ test/                     # æµ‹è¯•è„šæœ¬
â”‚   â””â”€â”€ maintenance/              # ç»´æŠ¤è„šæœ¬
â”œâ”€â”€ data/                         # æ•°æ®æ–‡ä»¶
â”‚   â””â”€â”€ memories/                 # è®°å¿†æ–‡æ¡£
â”œâ”€â”€ public/                       # é™æ€èµ„æº
â””â”€â”€ docs/                         # é¡¹ç›®æ–‡æ¡£
```

## ğŸ› ï¸ å¿«é€Ÿå¼€å§‹

### ç¯å¢ƒè¦æ±‚
- Node.js 18+
- npm/yarn/pnpm

### å®‰è£…ä¾èµ–
```bash
npm install
```

### ç¯å¢ƒé…ç½®
å¤åˆ¶ç¯å¢ƒå˜é‡æ¨¡æ¿ï¼š
```bash
cp env.example .env.local
```

é…ç½®ä»¥ä¸‹ç¯å¢ƒå˜é‡ï¼š
```bash
# OpenAI API é…ç½®
OPENAI_API_KEY=your_openai_api_key
OPENAI_API_BASE_URL=https://api.openai.com/v1

# Pinecone å‘é‡æ•°æ®åº“
PINECONE_API_KEY=your_pinecone_api_key
PINECONE_INDEX_NAME=igame-lab-memory
```

### æ•°æ®åº“è®¾ç½®

#### Linux/macOS è‡ªåŠ¨è®¾ç½®
```bash
# è®¾ç½®æ•°æ®åº“å¯†ç ï¼ˆæ ¹æ®éœ€è¦ä¿®æ”¹ï¼‰
export DB_PASSWORD=your_mysql_password

# è¿è¡Œè‡ªåŠ¨åŒ–è„šæœ¬
npm run setup-db
```

#### Windows è‡ªåŠ¨è®¾ç½®
```powershell
# ä½¿ç”¨ PowerShell è„šæœ¬ï¼ˆæ¨èï¼‰
.\scripts\setup-database-windows.ps1 -DB_PASSWORD your_mysql_password

# æˆ–ä½¿ç”¨ npm è„šæœ¬
npm run setup-db-windows
```

#### Windows æ‰‹åŠ¨è®¾ç½®

##### 1. å®‰è£… MySQL
1. ä¸‹è½½ MySQL Installerï¼š[https://dev.mysql.com/downloads/installer/](https://dev.mysql.com/downloads/installer/)
2. è¿è¡Œå®‰è£…ç¨‹åºï¼Œé€‰æ‹©ä»¥ä¸‹ç»„ä»¶ï¼š
   - MySQL Server
   - MySQL Shell
   - MySQL Router (å¯é€‰)
3. åœ¨å®‰è£…è¿‡ç¨‹ä¸­è®¾ç½® root å¯†ç 
4. éªŒè¯å®‰è£…ï¼š
   ```bash
   mysql --version
   ```

##### 2. åˆ›å»ºæ•°æ®åº“å’Œç”¨æˆ·
```sql
-- è¿æ¥åˆ° MySQL
mysql -u root -p

-- åˆ›å»ºæ•°æ®åº“
CREATE DATABASE IF NOT EXISTS igame_lab
CHARACTER SET utf8mb4
COLLATE utf8mb4_unicode_ci;

-- åˆ›å»ºåº”ç”¨ä¸“ç”¨ç”¨æˆ·
CREATE USER IF NOT EXISTS 'igame_app'@'localhost' IDENTIFIED BY 'your_password';
GRANT ALL PRIVILEGES ON igame_lab.* TO 'igame_app'@'localhost';
FLUSH PRIVILEGES;

-- é€€å‡º MySQL
EXIT;
```

##### 3. åˆ›å»ºæ•°æ®è¡¨
```sql
-- è¿æ¥åˆ°æ•°æ®åº“
mysql -u igame_app -p igame_lab

-- åˆ›å»ºå†…å­˜æ–‡æ¡£è¡¨
CREATE TABLE IF NOT EXISTS memory_documents (
  id VARCHAR(100) PRIMARY KEY,
  title VARCHAR(500) NOT NULL,
  content LONGTEXT NOT NULL,
  type VARCHAR(100) NOT NULL,
  file_name VARCHAR(500),
  chunk_index INT DEFAULT 0,
  total_chunks INT DEFAULT 1,
  pinecone_id VARCHAR(200) NOT NULL,
  status ENUM('active', 'deleted') DEFAULT 'active',
  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
  updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
  INDEX idx_status (status),
  INDEX idx_type (type),
  INDEX idx_created_at (created_at),
  INDEX idx_pinecone_id (pinecone_id),
  INDEX idx_file_name (file_name),
  FULLTEXT INDEX ft_title_content (title, content)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;

-- åˆ›å»ºå­¦ç”Ÿä¿¡æ¯è¡¨
CREATE TABLE IF NOT EXISTS students (
  id VARCHAR(100) PRIMARY KEY,
  chinese_name VARCHAR(100) NOT NULL,
  english_name VARCHAR(200),
  grade VARCHAR(50) NOT NULL,
  degree VARCHAR(50) NOT NULL,
  research VARCHAR(500),
  bio LONGTEXT,
  email VARCHAR(200),
  phone VARCHAR(20),
  avatar VARCHAR(500),
  github VARCHAR(500),
  linkedin VARCHAR(500),
  website VARCHAR(500),
  skills LONGTEXT,
  interests LONGTEXT,
  publications LONGTEXT,
  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
  updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
  INDEX idx_grade (grade),
  INDEX idx_degree (degree),
  INDEX idx_chinese_name (chinese_name),
  INDEX idx_english_name (english_name),
  FULLTEXT INDEX ft_bio_skills (bio, skills, interests)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;

-- åˆ›å»ºç»Ÿè®¡è§†å›¾
CREATE OR REPLACE VIEW memory_stats AS
SELECT
  COUNT(*) as total_documents,
  SUM(CASE WHEN status = 'active' THEN 1 ELSE 0 END) as active_documents,
  SUM(CASE WHEN status = 'deleted' THEN 1 ELSE 0 END) as deleted_documents,
  COUNT(DISTINCT type) as unique_types
FROM memory_documents;
```

##### 4. PowerShell æ‰§è¡Œç­–ç•¥
å¦‚æœ PowerShell è„šæœ¬æ— æ³•è¿è¡Œï¼š
```powershell
Set-ExecutionPolicy -ExecutionPolicy RemoteSigned -Scope CurrentUser
```

##### 5. å­¦ç”Ÿä¿¡æ¯ç®¡ç†
- ç‚¹å‡»å›¢é˜Ÿé¡µé¢ä¸­çš„å­¦ç”Ÿåå­—æ—¶ï¼Œå¦‚æœæ˜¾ç¤º404é”™è¯¯ï¼Œè¿™æ˜¯æ­£å¸¸ç°è±¡
- 404è¡¨ç¤ºè¯¥å­¦ç”Ÿä¿¡æ¯å°šæœªåˆ›å»ºï¼Œé¡µé¢ä¼šè‡ªåŠ¨è¿›å…¥ç¼–è¾‘æ¨¡å¼
- åªéœ€è¦å¡«å†™åŸºæœ¬ä¿¡æ¯å¹¶ä¿å­˜å³å¯åˆ›å»ºå­¦ç”Ÿèµ„æ–™

è„šæœ¬å°†è‡ªåŠ¨å®Œæˆï¼š
- âœ… æ£€æŸ¥ç³»ç»Ÿç¯å¢ƒ
- âœ… åˆ›å»ºæ•°æ®åº“å’Œç”¨æˆ·
- âœ… è®¾ç½®æƒé™
- âœ… åˆ›å»ºè¡¨å’Œè§†å›¾ï¼ˆåŒ…æ‹¬å­¦ç”Ÿä¿¡æ¯è¡¨ï¼‰
- âœ… ç”Ÿæˆé…ç½®æ–‡ä»¶
- âœ… éªŒè¯è®¾ç½®

**æ‰‹åŠ¨è®¾ç½®**
```bash
# Ubuntu/Debian
sudo apt update
sudo apt install mysql-server
sudo systemctl start mysql

# CentOS/RHEL
sudo yum install mysql-server
sudo systemctl start mysqld
```

é…ç½®æ•°æ®åº“ï¼š
```bash
# è¿æ¥åˆ°MySQL
mysql -u root -p

# åœ¨MySQLå‘½ä»¤è¡Œä¸­æ‰§è¡Œï¼š
CREATE DATABASE igame_lab CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;
CREATE USER 'igame_app'@'localhost' IDENTIFIED BY 'your_password';
GRANT ALL PRIVILEGES ON igame_lab.* TO 'igame_app'@'localhost';
FLUSH PRIVILEGES;
EXIT;
```

**åˆ›å»ºæ•°æ®è¡¨å’Œè§†å›¾**

å¦‚æœæ‚¨å€¾å‘äºæ‰‹åŠ¨åˆ›å»ºè¡¨å’Œè§†å›¾ï¼Œè¯·å‚è€ƒ [DATABASE.md](DATABASE.md) æ–‡æ¡£ä¸­çš„å®Œæ•´SQLè¯­å¥ã€‚

æˆ–è€…åœ¨MySQLå‘½ä»¤è¡Œä¸­ä¾æ¬¡æ‰§è¡Œä»¥ä¸‹SQLè¯­å¥ï¼š

```sql
-- åˆ‡æ¢åˆ°æ•°æ®åº“
USE igame_lab;

-- åˆ›å»ºè®°å¿†æ–‡æ¡£è¡¨
CREATE TABLE IF NOT EXISTS memory_documents (
  id VARCHAR(100) PRIMARY KEY,
  title VARCHAR(500) NOT NULL,
  content LONGTEXT NOT NULL,
  type VARCHAR(100) NOT NULL,
  file_name VARCHAR(500),
  chunk_index INT DEFAULT 0,
  total_chunks INT DEFAULT 1,
  pinecone_id VARCHAR(200) NOT NULL,
  status ENUM('active', 'deleted') DEFAULT 'active',
  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
  updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,

  INDEX idx_status (status),
  INDEX idx_type (type),
  INDEX idx_created_at (created_at),
  INDEX idx_pinecone_id (pinecone_id),
  INDEX idx_file_name (file_name),

  FULLTEXT INDEX ft_title_content (title, content)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;

-- åˆ›å»ºç»Ÿè®¡è§†å›¾
CREATE OR REPLACE VIEW memory_stats AS
SELECT
  COUNT(*) as total_documents,
  SUM(CASE WHEN status = 'active' THEN 1 ELSE 0 END) as active_documents,
  SUM(CASE WHEN status = 'deleted' THEN 1 ELSE 0 END) as deleted_documents,
  COUNT(DISTINCT type) as unique_types
FROM memory_documents;
```

#### Pinecone å‘é‡æ•°æ®åº“è®¾ç½®

**è·å– API å¯†é’¥**
1. è®¿é—® [Pineconeå®˜ç½‘](https://www.pinecone.io/)
2. åˆ›å»ºè´¦æˆ·å¹¶ç™»å½•
3. åœ¨æ§åˆ¶å°ä¸­åˆ›å»ºAPIå¯†é’¥

**åˆ›å»ºç´¢å¼•**
```bash
# è®¾ç½®ç¯å¢ƒå˜é‡
export PINECONE_API_KEY=your_api_key_here
export PINECONE_INDEX_NAME=igame-lab-memory  # å¯é€‰ï¼Œé»˜è®¤å€¼

# åˆ›å»ºç´¢å¼•
npm run create-pinecone-index
```

**é‡è¦è¯´æ˜**ï¼šPinecone APIå¯†é’¥æ˜¯å¿…éœ€çš„ï¼Œç³»ç»Ÿç°åœ¨å¼ºåˆ¶è¦æ±‚é…ç½®æ‰èƒ½ä½¿ç”¨è®°å¿†åŠŸèƒ½ã€‚

### åˆå§‹åŒ–æ•°æ®
```bash
# åˆå§‹åŒ–æ•°æ®åº“è¡¨
npm run init-db

# åˆå§‹åŒ–è®°å¿†æ•°æ®ï¼ˆå¯é€‰ï¼‰
npm run init-memories
```

### å¯åŠ¨å¼€å‘æœåŠ¡å™¨
```bash
npm run dev
```

æ‰“å¼€ [http://localhost:3000](http://localhost:3000) æŸ¥çœ‹åº”ç”¨ã€‚

## ğŸ“œ å¯ç”¨è„šæœ¬

### å¼€å‘å‘½ä»¤
```bash
npm run dev          # å¯åŠ¨å¼€å‘æœåŠ¡å™¨
npm run build        # æ„å»ºç”Ÿäº§ç‰ˆæœ¬
npm run start        # å¯åŠ¨ç”Ÿäº§æœåŠ¡å™¨
npm run lint         # ä»£ç æ£€æŸ¥
```

### æ•°æ®åº“ç®¡ç†
```bash
npm run setup-db                # è‡ªåŠ¨è®¾ç½®MySQLæ•°æ®åº“
npm run init-db                 # åˆå§‹åŒ–æ•°æ®åº“è¡¨å’Œè§†å›¾
npm run test-db                 # æµ‹è¯•æ•°æ®åº“è¿æ¥
npm run create-pinecone-index   # åˆ›å»º Pinecone ç´¢å¼•
npm run init-memories           # åˆå§‹åŒ–è®°å¿†æ•°æ®
npm run test-pinecone           # æµ‹è¯• Pinecone è¿æ¥
```

## ğŸ“Š SQLè¯­å¥å‚è€ƒ

### æ•°æ®åº“ç»“æ„

**1. å†…å­˜æ–‡æ¡£è¡¨ (memory_documents)**
```sql
CREATE TABLE IF NOT EXISTS memory_documents (
  id VARCHAR(100) PRIMARY KEY,
  title VARCHAR(500) NOT NULL,
  content LONGTEXT NOT NULL,
  type VARCHAR(100) NOT NULL,
  file_name VARCHAR(500),
  chunk_index INT DEFAULT 0,
  total_chunks INT DEFAULT 1,
  pinecone_id VARCHAR(200) NOT NULL,
  status ENUM('active', 'deleted') DEFAULT 'active',
  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
  updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,

  INDEX idx_status (status),
  INDEX idx_type (type),
  INDEX idx_created_at (created_at),
  INDEX idx_pinecone_id (pinecone_id),
  INDEX idx_file_name (file_name),

  FULLTEXT INDEX ft_title_content (title, content)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;
```

**2. å­¦ç”Ÿä¿¡æ¯è¡¨ (students)**
```sql
CREATE TABLE IF NOT EXISTS students (
  id VARCHAR(100) PRIMARY KEY,
  chinese_name VARCHAR(100) NOT NULL,
  english_name VARCHAR(200),
  grade VARCHAR(50) NOT NULL,
  degree VARCHAR(50) NOT NULL,
  research VARCHAR(500),
  bio LONGTEXT,
  email VARCHAR(200),
  phone VARCHAR(20),
  avatar VARCHAR(500),
  github VARCHAR(500),
  linkedin VARCHAR(500),
  website VARCHAR(500),
  skills LONGTEXT,
  interests LONGTEXT,
  publications LONGTEXT,
  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
  updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,

  INDEX idx_grade (grade),
  INDEX idx_degree (degree),
  INDEX idx_chinese_name (chinese_name),
  INDEX idx_english_name (english_name),

  FULLTEXT INDEX ft_bio_skills (bio, skills, interests)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;
```

**3. ç»Ÿè®¡è§†å›¾ (memory_stats)**
```sql
CREATE OR REPLACE VIEW memory_stats AS
SELECT
  COUNT(*) as total_documents,
  SUM(CASE WHEN status = 'active' THEN 1 ELSE 0 END) as active_documents,
  SUM(CASE WHEN status = 'deleted' THEN 1 ELSE 0 END) as deleted_documents,
  COUNT(DISTINCT type) as unique_types
FROM memory_documents;
```

### å¸¸ç”¨æŸ¥è¯¢è¯­å¥

**æ•°æ®æŸ¥è¯¢**
```sql
-- æŸ¥è¯¢æ´»è·ƒçš„å†…å­˜æ–‡æ¡£
SELECT id, title, type, created_at
FROM memory_documents
WHERE status = 'active'
ORDER BY created_at DESC
LIMIT 10;

-- æŒ‰ç±»å‹ç»Ÿè®¡æ–‡æ¡£æ•°é‡
SELECT type, COUNT(*) as count
FROM memory_documents
WHERE status = 'active'
GROUP BY type
ORDER BY count DESC;

-- æŸ¥è¯¢å­¦ç”Ÿä¿¡æ¯
SELECT id, chinese_name, english_name, grade, degree
FROM students
ORDER BY grade DESC, chinese_name ASC;

-- æŒ‰å¹´çº§ç»Ÿè®¡å­¦ç”Ÿæ•°é‡
SELECT grade, COUNT(*) as count
FROM students
GROUP BY grade
ORDER BY grade DESC;
```

**æ•°æ®åº“ç»´æŠ¤**
```sql
-- å¤‡ä»½æ•°æ®åº“
mysqldump -u igame_app -p igame_lab > igame_lab_backup.sql

-- æ¢å¤æ•°æ®åº“
mysql -u igame_app -p igame_lab < igame_lab_backup.sql

-- æ¸…ç†å·²åˆ é™¤çš„æ–‡æ¡£ï¼ˆè½¯åˆ é™¤å˜ç¡¬åˆ é™¤ï¼‰
DELETE FROM memory_documents
WHERE status = 'deleted'
AND updated_at < DATE_SUB(NOW(), INTERVAL 30 DAY);

-- ä¼˜åŒ–è¡¨
OPTIMIZE TABLE memory_documents;
OPTIMIZE TABLE students;
```

**æ€§èƒ½ç›‘æ§**
```sql
-- æŸ¥çœ‹è¡¨å¤§å°
SELECT
  table_name,
  ROUND(data_length / 1024 / 1024, 2) as data_mb,
  ROUND(index_length / 1024 / 1024, 2) as index_mb,
  ROUND((data_length + index_length) / 1024 / 1024, 2) as total_mb
FROM information_schema.tables
WHERE table_schema = 'igame_lab'
ORDER BY total_mb DESC;

-- æŸ¥çœ‹è¿æ¥çŠ¶æ€
SHOW PROCESSLIST;

-- æŸ¥çœ‹æ•°æ®åº“æ€§èƒ½æŒ‡æ ‡
SHOW ENGINE INNODB STATUS;
```

**ç”¨æˆ·ç®¡ç†**
```sql
-- æŸ¥çœ‹æ‰€æœ‰ç”¨æˆ·
SELECT user, host FROM mysql.user WHERE user LIKE 'igame%';

-- ä¿®æ”¹ç”¨æˆ·å¯†ç 
ALTER USER 'igame_app'@'localhost' IDENTIFIED BY 'new_secure_password';

-- åˆ é™¤ç”¨æˆ·
DROP USER 'igame_app'@'localhost';
DROP USER 'igame_app'@'%';
```

### é«˜çº§æ•°æ®åº“ç®¡ç†

#### æ•°æ®ä¸€è‡´æ€§æ£€æŸ¥
```sql
-- æ£€æŸ¥å¤–é”®çº¦æŸ
SELECT
  TABLE_NAME,
  COLUMN_NAME,
  CONSTRAINT_NAME,
  REFERENCED_TABLE_NAME,
  REFERENCED_COLUMN_NAME
FROM information_schema.KEY_COLUMN_USAGE
WHERE REFERENCED_TABLE_SCHEMA = 'igame_lab';

-- æ£€æŸ¥æ•°æ®å®Œæ•´æ€§
CHECK TABLE memory_documents;
CHECK TABLE students;

-- ä¿®å¤è¡¨ï¼ˆå¦‚æœå‘ç°é—®é¢˜ï¼‰
REPAIR TABLE memory_documents;
REPAIR TABLE students;
```

#### ç›‘æ§å’Œè¯Šæ–­
```sql
-- æŸ¥çœ‹æ•°æ®åº“å¤§å°æ€»è§ˆ
SELECT
  table_schema as 'Database',
  ROUND(SUM(data_length + index_length) / 1024 / 1024, 2) as 'Size (MB)',
  COUNT(*) as 'Tables'
FROM information_schema.tables
GROUP BY table_schema
ORDER BY SUM(data_length + index_length) DESC;

-- æŸ¥çœ‹ç´¢å¼•ä½¿ç”¨æƒ…å†µ
SELECT
  TABLE_NAME,
  INDEX_NAME,
  SEQ_IN_INDEX,
  COLUMN_NAME,
  CARDINALITY,
  PAGES,
  FILTER_CONDITION
FROM information_schema.STATISTICS
WHERE TABLE_SCHEMA = 'igame_lab'
ORDER BY TABLE_NAME, SEQ_IN_INDEX;

-- æŸ¥çœ‹é”ä¿¡æ¯
SHOW OPEN TABLES WHERE In_use > 0;

-- æŸ¥çœ‹InnoDBç¼“å†²æ± çŠ¶æ€
SHOW ENGINE INNODB STATUS\G
```

#### å®šæœŸç»´æŠ¤è„šæœ¬
```bash
#!/bin/bash
# æ•°æ®åº“å®šæœŸç»´æŠ¤è„šæœ¬

DB_USER="igame_app"
DB_NAME="igame_lab"
BACKUP_DIR="/var/backups/igame_lab"

# åˆ›å»ºå¤‡ä»½ç›®å½•
mkdir -p "$BACKUP_DIR"

# å¤‡ä»½æ•°æ®åº“
mysqldump -u "$DB_USER" -p "$DB_NAME" > "$BACKUP_DIR/igame_lab_$(date +%Y%m%d_%H%M%S).sql"

# åªä¿ç•™æœ€è¿‘7å¤©çš„å¤‡ä»½
find "$BACKUP_DIR" -name "igame_lab_*.sql" -mtime +7 -delete

# ä¼˜åŒ–è¡¨
mysql -u "$DB_USER" -p -e "
USE $DB_NAME;
OPTIMIZE TABLE memory_documents;
OPTIMIZE TABLE students;
ANALYZE TABLE memory_documents;
ANALYZE TABLE students;
"

echo "æ•°æ®åº“ç»´æŠ¤å®Œæˆ"
```

## ğŸš¨ å¿«é€Ÿæ•…éšœæ’é™¤

### æ•°æ®åº“è¿æ¥é—®é¢˜
```bash
# æµ‹è¯•æ•°æ®åº“è¿æ¥
npm run test-db

# å¦‚æœå¤±è´¥ï¼Œè¿è¡Œè‡ªåŠ¨è®¾ç½®
npm run setup-db
```

### å­¦ç”Ÿä¿¡æ¯ç›¸å…³é—®é¢˜
```bash
# ç‚¹å‡»å­¦ç”Ÿåå­—æ˜¾ç¤º404é”™è¯¯ï¼ˆè¿™æ˜¯æ­£å¸¸ç°è±¡ï¼‰
# 404è¡¨ç¤ºå­¦ç”Ÿä¿¡æ¯å°šæœªåˆ›å»ºï¼Œé¡µé¢ä¼šè‡ªåŠ¨è¿›å…¥ç¼–è¾‘æ¨¡å¼

# å¦‚æœé¡µé¢æ²¡æœ‰è‡ªåŠ¨è¿›å…¥ç¼–è¾‘æ¨¡å¼ï¼Œè¯·åˆ·æ–°é¡µé¢
# æˆ–è€…ç›´æ¥è®¿é—®: http://localhost:3000/team/[student_id]

# ç¤ºä¾‹ï¼š
# http://localhost:3000/team/wang_shiqi
# http://localhost:3000/team/li_si
```

### Pineconeè¿æ¥é—®é¢˜
```bash
# æµ‹è¯•Pineconeè¿æ¥
npm run test-pinecone
```

### Pinecone è¿æ¥é—®é¢˜
```bash
# æµ‹è¯•Pineconeè¿æ¥
npm run test-pinecone

# å¦‚æœå¤±è´¥ï¼Œæ£€æŸ¥APIå¯†é’¥é…ç½®
echo $PINECONE_API_KEY
```

### è®°å¿†æ–‡æ¡£æ˜¾ç¤ºé—®é¢˜
å¦‚æœè®°å¿†æ–‡æ¡£åˆ—è¡¨æ˜¾ç¤º0ä¸ªæ–‡æ¡£ä½†Pineconeä¸­æœ‰è®°å½•ï¼š

1. **æ£€æŸ¥ç¯å¢ƒå˜é‡**
   ```bash
   # ç¡®ä¿APIå¯†é’¥æ­£ç¡®é…ç½®
   npm run test-pinecone
   ```

2. **å¸¸è§åŸå› **
   - å‘é‡ç»´åº¦ä¸åŒ¹é…ï¼ˆéœ€è¦1536ç»´ï¼‰
   - æŸ¥è¯¢ç­–ç•¥é—®é¢˜
   - APIæƒé™ä¸è¶³

3. **å¿«é€Ÿä¿®å¤**
   ```bash
   # é‡æ–°ç”Ÿæˆå‘é‡
   # åˆ é™¤ç°æœ‰æ–‡æ¡£ï¼Œé‡æ–°ä¸Šä¼ 
   ```

### åº”ç”¨æ— æ³•å¯åŠ¨
```bash
# æ£€æŸ¥ç¯å¢ƒå˜é‡
cat .env.local

# é‡æ–°å®‰è£…ä¾èµ–
rm -rf node_modules package-lock.json
npm install
```

## ğŸš€ éƒ¨ç½²

### Vercel éƒ¨ç½²
1. è¿æ¥ GitHub ä»“åº“åˆ° Vercel
2. é…ç½®ç¯å¢ƒå˜é‡
3. è‡ªåŠ¨éƒ¨ç½²å®Œæˆ

### æ‰‹åŠ¨éƒ¨ç½²
```bash
npm run build
npm run start
```

## ğŸ“š ç›¸å…³æ–‡æ¡£

- [upgraded_project_documentation.md](upgraded_project_documentation.md) - é¡¹ç›®æŠ€æœ¯æ¶æ„å’Œå‡çº§æ–¹æ¡ˆ
- [APIæ–‡æ¡£](https://igame-lab.dasusm.com/api-docs) - REST API æ¥å£æ–‡æ¡£
- [éƒ¨ç½²æŒ‡å—](https://igame-lab.dasusm.com/deploy) - ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²æŒ‡å—

## ğŸ¤ è´¡çŒ®æŒ‡å—

1. Fork æœ¬ä»“åº“
2. åˆ›å»ºç‰¹æ€§åˆ†æ”¯ (`git checkout -b feature/AmazingFeature`)
3. æäº¤æ›´æ”¹ (`git commit -m 'Add some AmazingFeature'`)
4. æ¨é€åˆ°åˆ†æ”¯ (`git push origin feature/AmazingFeature`)
5. åˆ›å»º Pull Request

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ MIT è®¸å¯è¯ - æŸ¥çœ‹ [LICENSE](LICENSE) æ–‡ä»¶äº†è§£è¯¦æƒ…ã€‚

## ğŸ“ è”ç³»æˆ‘ä»¬

iGame Lab - [å®éªŒå®¤å®˜ç½‘](https://igame-lab.dasusm.com)

é¡¹ç›®ç»´æŠ¤è€…ï¼šå¾å²—æ•™æˆç ”ç©¶å›¢é˜Ÿ